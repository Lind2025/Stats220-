---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)

```
 
```{css}

```

## What's going on with this data?

You need to change the contents of this Rmd! Replace the R code and markdown give below in this template document.

```{r}

library(tidyverse)
## data load

logged_data = read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vTUV2Zh8ODNKQVXaxTVKh35PTMexvnA7ocRS8FFg_xCbRyEbtaEuR-7zewIq6x0JoCoIGVMpfrKxPHP/pub?gid=618838588&single=true&output=csv")

## View data structure

glimpse(logged_data)    # Quickly examine data structures
head(logged_data)       # View the first few lines of data

## data prepare

latest_data = logged_data %>% 
  rename(Date=2,Time=3,Passengers=4,P_action =5,bus_full_Status =6,comfort_rate=7)

latest_data  = latest_data[ ,-1] #Remove the first column (unwanted data)

## Summary values

summary_values <- latest_data %>%
  summarise(
    # Calculate the mean, maximum, and minimum number of passengers
    Avg_Passenger_Count = mean(Passengers, na.rm = TRUE),
    Max_Passenger_Count = max(Passengers, na.rm = TRUE),
    Avg_Environment_Rating = mean(comfort_rate, na.rm = TRUE)
  )

print(summary_values)

## parts of bar charts
## passengers number count in diff

latest_data %>% 
  ggplot() +
   geom_bar(aes(x = Time),fill = "pink") +
  labs(title = "Passenger Count by Time Period", 
       x = "Time", 
       y = "Passengers") +
  theme_minimal()

## bus_full_Status & comfort_rate
latest_data %>% 
  ggplot() +
  geom_bar(aes(x = comfort_rate),fill = "blue") +
  labs(title = "What is the full status of the bus for passengers' comfort", 
       x = "comfort_rate", 
       y = "bus_full_Status") +
  theme_minimal()



```

The best pet to have is a `r best_pet` of course!

![](https://c.tenor.com/-qBsG1HwR4oAAAAC/tenor.gif)
